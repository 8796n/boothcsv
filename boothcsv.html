<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="utf-8">
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/paper-css/0.4.1/paper.css">

  <link rel="stylesheet" href="./css/boothcsv.css">

  <title>BOOTH宛名印刷用CSV帳票化</title>
</head>

<body class="A4">
<div class="no_print" style="text-align: center;">
  <h1>BOOTHの宛名印刷用CSVを使って出荷用のラベルシールやピッキング用の帳票を作成するためのもの</h1>
  <p><a href="https://manage.booth.pm/orders?state=paid" target="_blank">BOOTHの注文一覧(未発送)</a>から「宛名印刷用CSV」をダウンロード</p>
  <form method="POST" enctype="multipart/form-data" id="form">
    <table class="form-table" style="margin: 0 auto;">
      <tr>
        <td><label for="csvfile">宛名印刷用CSVファイル：</label></td>
        <td><input type="file" id="file" name="csvfile" accept=".csv"></td>
      </tr>
      <tr>
        <td><label for="labelprint">ラベルシールも印刷する：</label></td>
        <td><input type="checkbox" id="labelyn" name="labelprint" checked></td>
      </tr>
      <tr>
        <td><label for="sortByPaymentDate">支払い日時で並び替え：</label></td>
        <td><input type="checkbox" id="sortByPaymentDate" name="sortByPaymentDate" title="BOOTHからダウンロードしたCSVは新しい注文が上に来るので、支払いの古い順に並べ替えたい場合はチェックしてください。"></td>
      </tr>
      <tr>
        <td><label for="labelskip">ラベルをスキップする面数：</label></td>
        <td><input type="number" min="0" max="43" id="labelskipnum" name="labelskip" value="0"></td>
      </tr>
      <tr>
        <td><label for="customLabelEnable">残りラベルに任意文字列を印刷：</label></td>
        <td><input type="checkbox" id="customLabelEnable" name="customLabelEnable"></td>
      </tr>
      <tr id="customLabelRow" style="display: none;">
        <td colspan="2">
          <div class="multiple-custom-labels-config">
            <div class="custom-labels-header">
              <h4>カスタムラベル設定</h4>
              <div class="custom-labels-buttons">
                <button type="button" id="addCustomLabelBtn" class="btn-base btn-success btn-medium">ラベル追加</button>
                <button type="button" id="clearCustomLabelsBtn" class="btn-base btn-danger btn-medium">全削除</button>
              </div>
            </div>
            <div id="customLabelsContainer" class="custom-labels-container">
              <!-- 複数のカスタムラベル項目がここに追加される -->
            </div>
            <div class="custom-labels-summary">
              <div id="customLabelsSummary" class="custom-labels-summary">※残りラベル数に応じて上限が自動調整されます</div>
            </div>
          </div>
        </td>
      </tr>
      <tr>
        <td><label for="orderImageEnable">注文明細に画像を表示：</label></td>
        <td><input type="checkbox" id="orderImageEnable" name="orderImageEnable"></td>
      </tr>
      <tr id="orderImageRow" style="display: none;">
        <td colspan="2">
          <div id="imageDropZone" class="dropzone-container" style="text-align: center;"></div>
        </td>
      </tr>
    </table>
    <div class="form-actions" style="text-align: center;">
      <button type="button" class="btn-action" onClick="clickstart();" id="executeButton" disabled>CSV処理して実行</button>
      <button type="button" class="btn-action" onClick="executeCustomLabelsOnly();" id="customLabelOnlyButton" disabled>カスタムラベルのみ実行</button>
      <button type="button" class="btn-action" onClick="window.print();" id="printButton" disabled>印刷</button>
    </div>
  </form>
  <p style="text-align: center;">ローカルストレージに保存された画像を全削除：
    <button id="clearAllButton" class="btn-base btn-danger btn-clear">全てのQR画像をクリア</button>
    <button id="clearAllOrderImagesButton" class="btn-base btn-danger btn-clear">全ての注文画像をクリア</button>
  </p>
  <div style="text-align: center; margin: 15px 0;">
    <a href="help.html" target="_blank" style="background-color: #28a745; color: white; padding: 6px 12px; text-decoration: none; border-radius: 4px; margin: 0 5px;">📚 使い方ガイド</a>
    <a href="help.html#画像機能について" target="_blank" style="background-color: #17a2b8; color: white; padding: 6px 12px; text-decoration: none; border-radius: 4px; margin: 0 5px;">🖼️ 画像機能の説明</a>
    <a href="help.html#カスタムラベル機能について" target="_blank" style="background-color: #fd7e14; color: white; padding: 6px 12px; text-decoration: none; border-radius: 4px; margin: 0 5px;">🏷️ カスタムラベル機能</a>
  </div>
  <p><a href="https://github.com/8796n/boothcsv" target="_blank">このツールの公開場所</a></p>
</div>
<template id="L44">
  <section class="sheet">
      <table class="label44">
      </table>
    </section>
</template>
<template id="customLabelItem">
  <div class="custom-label-item">
    <div class="custom-label-item-header">
      <div class="custom-label-item-header-left">
        <input type="checkbox" class="custom-label-enabled" checked>
        <label class="custom-label-item-title">印刷する</label>
      </div>
      <button type="button" class="btn-base btn-danger btn-small btn-remove">削除</button>
    </div>
    <div class="custom-label-input-group">
      <div class="custom-label-editor-row">
        <div class="rich-text-editor" contenteditable="true" 
             placeholder="印刷したい文字列を入力してください..."
             style="font-size: 12pt;"></div>
        <div class="custom-label-count-group">
          <label>印刷面数：</label>
          <input type="number" min="1" value="1">
        </div>
      </div>
    </div>
  </div>
</template>
<template id="注文明細">
  <section class="sheet">
    <div class="page">
      <div class="header">
        <p class="title">注文明細</p>
        <div class="topright">
          <p class="注文番号"></p>
        </div>
        <table class="orderdetail">
          <tr>
            <td>郵便番号</td>
            <td class="郵便番号">【あんしんBOOTHパック】</td>
            <td>注文状況</td>
            <td class="注文状況"></td>
          </tr>
          <tr>
            <td>都道府県</td>
            <td class="都道府県">【あんしんBOOTHパック】</td>
            <td>注文日時</td>
            <td class="注文日時"></td>
          </tr>
          <tr>
            <td>住所１</td>
            <td class="市区町村・丁目・番地">【あんしんBOOTHパック】</td>
            <td>支払い日時</td>
            <td class="支払い日時"></td>
          </tr>
          <tr>
            <td>住所２</td>
            <td class="マンション・建物名・部屋番号"></td>
            <td>お支払方法</td>
            <td class="お支払方法"></td>
          </tr>
          <tr>
            <td>氏名</td>
            <td class="氏名">【あんしんBOOTHパック】</td>
            <td>ユーザー識別コード</td>
            <td class="ユーザー識別コード"></td>
          </tr>
          <tr>
            <td>電話番号</td>
            <td class="電話番号">【あんしんBOOTHパック】</td>
          </tr>
        </table>
      </div>
      <table class="items">
        <tr>
          <th>商品ID</th><th>商品名</th><th>数量</th><th>確認</th>
        </tr>
        <template id="商品">
          <tr>
            <td class="商品ID"></td><td class="商品名"></td><td class="数量"></td><td class="確認"></td>
          </tr>
        </template>
        <tr>
          <td class="spacerow" colspan="4">以下余白</td>
        </tr>
      </table>
      <!-- 個別注文画像ドロップゾーン -->
      <div class="individual-order-image-zone" style="margin: 10px 0; text-align: center; border: 2px dashed #ccc; padding: 10px;">
        <small>この注文専用の画像（グローバル画像より優先されます）</small>
        <div class="individual-image-dropzone"></div>
      </div>
      <!-- 画像表示用のコンテナを追加 -->
      <div class="order-image-container"></div>
    </div>
  </section>
</template>
<div id="dropZoneDefaultContent" style="display: none;">
  <p>注文明細の余白に表示したい画像をここにドロップ or クリックでファイルを選択</p>
</div>
<script src="./js/jsQR.js"></script>
<script src="./js/papaparse.min.js"></script>
<script src="./js/boothcsv.js"></script>
</body>

</html>